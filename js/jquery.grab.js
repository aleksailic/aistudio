(function(e){function f(t,n,r){if(n.substr(0,5)!=="touch"){return e(t).unbind(n,r)}var i,s;for(s=0;s<l._binds.length;s++){if(l._binds[s].elem===t&&l._binds[s].type===n&&l._binds[s].func===r){if(document.addEventListener){t.removeEventListener(n,l._binds[s].fnc,false)}else{t.detachEvent("on"+n,l._binds[s].fnc)}l._binds.splice(s--,1)}}}function l(t,n,r,i){if(n.substr(0,5)!=="touch"){return e(t).bind(n,i,r)}var s,o;if(l[n]){return l[n].bind(t,n,r,i)}s=function(e){if(!e){e=window.event}if(!e.stopPropagation){e.stopPropagation=function(){this.cancelBubble=true}}e.data=i;r.call(t,e)};if(document.addEventListener){t.addEventListener(n,s,false)}else{t.attachEvent("on"+n,s)}l._binds.push({elem:t,type:n,func:r,fnc:s})}function c(e,r){var i={move:{x:0,y:0},offset:{x:0,y:0},position:{x:0,y:0},start:{x:0,y:0},affects:document.documentElement,stopPropagation:false,preventDefault:true,touch:true};t(i,r);i.element=e;l(e,n,p,i);if(i.touch){l(e,s,m,i)}}function h(e){f(e,n,n)}function p(e){e.data.position.x=e.pageX;e.data.position.y=e.pageY;e.data.start.x=e.pageX;e.data.start.y=e.pageY;e.data.event=e;if(e.data.onstart&&e.data.onstart.call(e.data.element,e.data)){return}if(e.preventDefault&&e.data.preventDefault){e.preventDefault()}if(e.stopPropagation&&e.data.stopPropagation){e.stopPropagation()}l(e.data.affects,r,d,e.data);l(e.data.affects,i,v,e.data)}function d(e){if(e.preventDefault&&e.data.preventDefault){e.preventDefault()}if(e.stopPropagation&&e.data.preventDefault){e.stopPropagation()}e.data.move.x=e.pageX-e.data.position.x;e.data.move.y=e.pageY-e.data.position.y;e.data.position.x=e.pageX;e.data.position.y=e.pageY;e.data.offset.x=e.pageX-e.data.start.x;e.data.offset.y=e.pageY-e.data.start.y;e.data.event=e;if(e.data.onmove){e.data.onmove.call(e.data.element,e.data)}}function v(e){if(e.preventDefault&&e.data.preventDefault){e.preventDefault()}if(e.stopPropagation&&e.data.stopPropagation){e.stopPropagation()}f(e.data.affects,r,d);f(e.data.affects,i,v);e.data.event=e;if(e.data.onfinish){e.data.onfinish.call(e.data.element,e.data)}}function m(e){e.data.position.x=e.touches[0].pageX;e.data.position.y=e.touches[0].pageY;e.data.start.x=e.touches[0].pageX;e.data.start.y=e.touches[0].pageY;e.data.event=e;if(e.data.onstart&&e.data.onstart.call(e.data.element,e.data)){return}if(e.preventDefault&&e.data.preventDefault){e.preventDefault()}if(e.stopPropagation&&e.data.stopPropagation){e.stopPropagation()}l(e.data.affects,o,g,e.data);l(e.data.affects,u,y,e.data)}function g(e){if(e.preventDefault&&e.data.preventDefault){e.preventDefault()}if(e.stopPropagation&&e.data.stopPropagation){e.stopPropagation()}e.data.move.x=e.touches[0].pageX-e.data.position.x;e.data.move.y=e.touches[0].pageY-e.data.position.y;e.data.position.x=e.touches[0].pageX;e.data.position.y=e.touches[0].pageY;e.data.offset.x=e.touches[0].pageX-e.data.start.x;e.data.offset.y=e.touches[0].pageY-e.data.start.y;e.data.event=e;if(e.data.onmove){e.data.onmove.call(e.data.elem,e.data)}}function y(e){if(e.preventDefault&&e.data.preventDefault){e.preventDefault()}if(e.stopPropagation&&e.data.stopPropagation){e.stopPropagation()}f(e.data.affects,o,g);f(e.data.affects,u,y);e.data.event=e;if(e.data.onfinish){e.data.onfinish.call(e.data.element,e.data)}}var t=e.extend,n="mousedown",r="mousemove",i="mouseup",s="touchstart",o="touchmove",u="touchend",a="touchcancel";l._binds=[];e.fn.grab=function(e,t){return this.each(function(){return c(this,e,t)})};e.fn.ungrab=function(e){return this.each(function(){return h(this,e)})}})(jQuery)